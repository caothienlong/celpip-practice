# ğŸ¤– Cursor AI Assistant Rules for CELPIP Project

## ğŸš¨ CRITICAL GIT RULES (NEVER BREAK THESE)

### âŒ ABSOLUTELY FORBIDDEN
1. **NEVER commit directly to `main` or `master` branch**
2. **NEVER push directly to `main` or `master` branch**
3. **NEVER merge branches without user approval**
4. **NEVER run `git push origin main` or `git push origin master`**
5. **NEVER use `--force` or `--force-with-lease` on main/master**

### âœ… ALWAYS DO THIS INSTEAD

#### For ANY Code Changes:
```bash
# 1. Create a feature branch first
git checkout -b feature/descriptive-name
# or
git checkout -b fix/bug-description
# or
git checkout -b docs/documentation-update

# 2. Make your changes and commit
git add -A
git commit -m "descriptive commit message"

# 3. Push to the feature branch (NOT main)
git push origin feature/descriptive-name

# 4. Let the USER create the Pull Request
# DO NOT merge, let user review and merge
```

#### Branch Naming Conventions:
- `feature/` - New features (e.g., `feature/oauth-login`)
- `fix/` - Bug fixes (e.g., `fix/scoring-calculation`)
- `docs/` - Documentation only (e.g., `docs/update-readme`)
- `refactor/` - Code refactoring (e.g., `refactor/user-data-structure`)
- `test/` - Test additions/changes (e.g., `test/add-unit-tests`)
- `chore/` - Maintenance tasks (e.g., `chore/update-dependencies`)

---

## ğŸ“ Commit Message Standards

### Format:
```
<type>: <short description>

<optional detailed explanation>

<optional footer>
```

### Types:
- `feat:` - New feature
- `fix:` - Bug fix
- `docs:` - Documentation only
- `style:` - Formatting, missing semicolons, etc
- `refactor:` - Code restructuring
- `test:` - Adding tests
- `chore:` - Maintenance tasks

### Examples:
```
feat: Add Google OAuth login functionality

fix: Correct scoring calculation for reading tests

docs: Update deployment guide with OAuth setup

refactor: Move user data to folder-per-user structure
```

---

## ğŸ”’ Security Rules

### âŒ NEVER Commit These:
- `.env` files (should be in `.gitignore`)
- API keys or secrets
- OAuth client secrets
- Database passwords
- Private keys
- User data files

### âœ… ALWAYS Check:
- Secrets are in `.gitignore`
- `.env.example` exists (without real secrets)
- User data folder (`users/`) is gitignored
- No hardcoded credentials in code

---

## ğŸ“ File Management Rules

### When Creating New Files:
1. âœ… Check if file should be in `.gitignore`
2. âœ… Use appropriate file structure
3. âœ… Add documentation if needed

### When Deleting Files:
1. âœ… Ask user for confirmation first
2. âœ… Explain impact of deletion
3. âœ… Suggest alternatives if applicable

### When Modifying Files:
1. âœ… Read file first before editing
2. âœ… Preserve existing formatting
3. âœ… Test changes if possible

---

## ğŸ§ª Testing Requirements

### Before Committing:
1. âœ… Ensure code runs without errors
2. âœ… Check for linter errors if applicable
3. âœ… Verify no breaking changes
4. âœ… Test OAuth flow if authentication code changed
5. âœ… Test both guest and authenticated modes

---

## ğŸ“š Documentation Rules

### When Adding Features:
1. âœ… Update relevant documentation files
2. âœ… Add code comments for complex logic
3. âœ… Update README.md if user-facing
4. âœ… Update CHANGELOG.md for significant changes

### When Fixing Bugs:
1. âœ… Document the fix in commit message
2. âœ… Add troubleshooting section if applicable

---

## ğŸš€ Deployment Considerations

### Before Suggesting Deployment:
1. âœ… Ensure all dependencies in `requirements.txt`
2. âœ… Check environment variables are documented
3. âœ… Verify `.gitignore` is correct
4. âœ… Test locally first
5. âœ… Consider backward compatibility

### When Updating Dependencies:
1. âœ… Test locally after update
2. âœ… Check for breaking changes
3. âœ… Update documentation if needed
4. âœ… Consider Python version compatibility

---

## ğŸ’¬ Communication Rules

### When Suggesting Changes:
1. âœ… Explain WHY, not just WHAT
2. âœ… Provide context and reasoning
3. âœ… Suggest alternatives when possible
4. âœ… Highlight potential risks

### When User Says "Don't Do X":
1. âœ… Remember it for entire session
2. âœ… Add it to these rules if critical
3. âœ… Never do X again without explicit permission

---

## ğŸ¯ Project-Specific Rules

### CELPIP Practice Platform:

#### User Data:
- All user data in `users/{username}/` folder
- Each user has `profile.json` and `test_history.json`
- Never commit user data to Git

#### OAuth:
- Google and Facebook OAuth supported
- Environment variables in `.env` (local) or Render (production)
- Never commit OAuth secrets

#### Test Content:
- Tests in `data/test_X/skill/partY.json`
- Follow existing JSON structure
- Validate JSON before committing

#### Templates:
- Jinja2 templates in `templates/`
- Keep CELPIP-style UI consistent
- Test both Practice and Test modes

---

## ğŸ”§ Development Workflow

### Standard Workflow:
```bash
# 1. Always start from main
git checkout main
git pull origin main

# 2. Create feature branch
git checkout -b feature/your-feature

# 3. Make changes, test locally
python app.py  # Test at http://127.0.0.1:5000

# 4. Commit changes
git add -A
git commit -m "feat: Your feature description"

# 5. Push to feature branch
git push origin feature/your-feature

# 6. User creates PR and merges
```

### For Urgent Fixes:
```bash
# Still use a branch (e.g., hotfix/critical-bug)
git checkout -b hotfix/critical-bug
# ... make changes ...
git push origin hotfix/critical-bug
# User can merge faster, but still review
```

---

## ğŸ“‹ Pre-Commit Checklist

Before every commit, verify:
- [ ] No `.env` file in commit
- [ ] No user data in commit
- [ ] No API keys or secrets
- [ ] Code tested locally
- [ ] Commit message is descriptive
- [ ] On a feature branch (not main/master)
- [ ] Changes are focused (one feature/fix per branch)

---

## ğŸš« What to Do If Rules Are Broken

If you accidentally:
1. Commit to main â†’ `git reset --soft HEAD~1` then create branch
2. Include secrets â†’ Remove commit, update `.gitignore`, recommit
3. Break something â†’ Create fix branch immediately

**ALWAYS tell the user what happened and how to fix it!**

---

## ğŸ“ Learning from Mistakes

### Past Mistakes to Never Repeat:
1. âŒ Pushed to main directly (2025-12-08) - NEVER AGAIN
2. âŒ (Add more as they occur)

### Lessons Learned:
1. âœ… Always create feature branch first
2. âœ… User controls merging to main
3. âœ… (Add more as we learn)

---

## ğŸ“ When In Doubt

### Ask the User:
- "Should I create a new branch for this?"
- "Is it OK to modify this file?"
- "Should this be in .gitignore?"
- "Do you want to review before I push?"

### Better to Ask Than Assume!

---

## ğŸ¯ Summary

**Golden Rules:**
1. ğŸš¨ **NEVER touch main/master directly**
2. ğŸŒ¿ **ALWAYS use feature branches**
3. ğŸ”’ **NEVER commit secrets**
4. ğŸ“ **ALWAYS write clear commit messages**
5. ğŸ§ª **TEST before committing**
6. ğŸ’¬ **COMMUNICATE clearly with user**

---

**Last Updated:** December 8, 2025  
**Version:** 1.0  
**Status:** Active âœ…

---

*These rules are mandatory for all AI assistant interactions with this repository.*

